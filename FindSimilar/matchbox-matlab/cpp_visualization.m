clear all;

[data, sr] = wavread('samples/named/02-pullover-3.wav');

% Note: they don't take the log of the mel freq bins

%                                         'wintime', 0.025,...

[cepstra, aspectrum, pspectrum] = melfcc(data, sr,...
                                        'wintime', 0.025,...
                                        'hoptime', 0.01,...
                                        'numcep', 13,...
                                        'lifterexp',0,...
                                        'sumpower', 1,...
                                        'preemph', 0.97,...
                                        'dither',0,...
                                        'minfreq',133.33,...
                                        'maxfreq',6855.6,...
                                        'nbands',40,...
                                        'bwidth',1.0,...
                                        'dcttype',2,...
                                        'fbtype','htkmel',...
                                        'usecmp',0,...
                                        'modelorder',0);
                                    
[data_new, sr] = wavread('samples/named/02-pullover-3.wav');                                    
                                    
[ceps1,freqresp1,fb1,fbrecon1,freqrecon1] = mfcc(data_new, sr, 100);
cpp_out_cepstra = [-9.68373, -10.6775, -10.2421, -8.33066, -8.82461, -9.07203, -8.72141, -7.69314, -7.86578, -8.05979, -7.80546, -8.27683, -8.55597, -9.39789, -11.49, -12.1406, -12.3963, -10.7637, -8.59991, -8.52359, -8.13896, -7.4607, -5.78369, -6.9028, -7.24382, -8.20824, -8.23125, -8.12903, -8.96387, -9.90955, -9.58637, -9.85943, -10.6841, -10.4448, -10.4688, -10.5807, -11.1867, -12.5752, -11.9667, -12.2841, -11.4132, -9.64936, -7.24482, -6.61575, -5.32017, -6.39836, -8.6347, -9.67589, -11.8881, -12.3038, -13.8237, -12.9659, -13.0427, -12.5873, -13.0445, -14.0953, -15.18, -17.1748, -18.3902, -20.2658, -20.7439, -21.7371, -22.9904; -0.670004, -1.04341, 0.758603, 3.76234, 4.50854, 5.18921, 5.4308, 4.86922, 5.67115, 4.29428, 5.03578, 5.24506, 5.43223, 5.53607, 5.74456, 6.17469, 5.9078, 6.64671, 6.36564, 6.67174, 6.16356, 5.59322, 3.97193, 5.27813, 5.70176, 5.92634, 5.44263, 5.32621, 6.21813, 6.1996, 5.68064, 5.28105, 6.24422, 6.34579, 6.50606, 6.2239, 5.45148, 6.11915, 5.35133, 5.66441, 6.73989, 7.75714, 7.14037, 7.05743, 4.78711, 4.80308, 6.10281, 6.17774, 5.99276, 4.98884, 5.92575, 4.34166, 3.71519, 3.64825, 3.99373, 4.93567, 5.14389, 5.26965, 5.55081, 5.03112, 5.41757, 5.08258, 5.16925; -1.34274, -1.62902, -0.936967, 0.917763, 0.939732, 1.31637, 0.611181, -0.113415, -1.36859, -0.450322, -0.327256, -0.479317, -0.558657, -0.541909, -0.728189, -0.480452, -0.455954, -1.22781, -2.24909, -1.44617, -1.09777, -0.505243, 1.10863, 0.0752391, -0.637055, -0.94093, -0.486039, 0.0221774, -0.296995, -0.0385812, 0.481102, 0.635263, -0.355052, -0.398218, 0.366644, 0.689567, 0.916639, 0.5445, 0.741075, 0.527294, -0.39885, -1.35102, -2.30346, -1.95047, -0.312425, -0.257506, -0.788978, -1.61634, -1.833, -1.78517, -1.40897, 0.257025, 1.43732, -1.98134, -1.93558, -1.53008, -1.63395, -1.3295, -1.17713, -1.28887, -0.781707, -0.745877, 0.198564; 0.0933704, -1.18358, -0.35546, -0.344078, -0.190419, -0.338838, 0.198431, 1.41626, 1.14425, -0.580508, -0.311117, 0.39952, 0.106323, -0.00821763, 0.348176, 1.17398, 1.37251, 1.26949, 1.81751, 2.27, 2.60036, 2.37846, 1.57255, 2.27911, 2.31355, 3.19009, 2.99356, 2.66302, 2.84276, 3.80513, 3.2084, 3.57837, 3.74819, 3.84533, 3.49644, 3.11315, 2.70349, 2.86129, 1.95514, 1.62547, 2.33637, 2.96679, 3.21147, 3.12926, 1.75901, 1.25979, 2.01706, 2.14951, 2.36785, 1.78218, 1.688, 0.689022, 1.0842, 0.339908, 0.636407, 0.494286, 0.753709, 0.956333, 1.12172, 0.387341, 0.580644, 0.0383997, 0.673762; 0.130315, -0.0816154, 0.373907, -0.615101, -0.415045, -0.711903, -0.810589, -0.321523, 0.579118, -0.365184, -0.240413, 0.379132, 0.601341, 0.788109, 1.56825, 0.487991, 0.409644, 0.241027, 0.340546, -0.818075, -1.76572, -1.78477, -2.53048, -3.03907, -3.4866, -4.04143, -3.7974, -4.07703, -4.20709, -3.86744, -3.73075, -3.73156, -3.53121, -3.69742, -3.39819, -2.64168, -2.28835, -3.17286, -2.49365, -2.86255, -3.48251, -3.80174, -4.55622, -4.93303, -4.42402, -4.46814, -5.1182, -5.5545, -5.07149, -5.4099, -4.86463, -3.77549, -2.76391, -2.5272, -2.51391, -2.54707, -2.66829, -3.46351, -3.91083, -4.11085, -3.70357, -3.31352, -3.31734; -0.112932, 0.173091, 0.304289, -0.568666, -1.70388, -1.71129, -1.71574, -2.43221, -1.6476, -0.173888, 0.615723, 0.681741, 1.04434, 1.05416, 0.800306, 0.834846, 1.50468, 0.532708, -0.353233, -0.494773, -0.49609, -0.439633, -0.789046, -1.68088, -1.8835, -1.98653, -1.89752, -2.20152, -2.26436, -2.25089, -2.17763, -2.03076, -2.27182, -2.26323, -1.85205, -1.52018, -1.44886, -2.37491, -1.81582, -1.98789, -1.26037, -1.25516, -0.998371, -0.65456, -1.0052, -1.41323, -1.36166, -0.677484, 0.139963, -0.516096, -0.884213, -2.16828, -2.77406, -0.896333, -0.630704, -1.08417, -0.421756, -0.803838, -0.775602, -1.12434, -0.986076, -1.30416, -1.19715; -0.729337, -1.05977, -0.211383, 0.0571541, -0.803909, -0.046792, 0.623485, 0.891925, 0.36495, 0.76139, 1.22453, 1.10296, 1.12363, 1.15772, 1.35656, 1.06204, 1.09956, 0.359069, 0.821523, 1.28153, 1.78607, 1.91244, 1.10009, 1.3142, 1.04348, 0.831475, 0.915151, 1.01577, 1.48329, 1.00528, 0.89634, 0.903759, 0.816936, 1.0648, 0.316479, -0.163098, 0.03517, 0.345916, 0.22003, 0.598189, 0.981114, 0.954249, 0.690718, 0.703525, 0.287085, 0.261471, 1.03624, 0.921312, 1.57402, 1.36689, 0.385358, 1.14009, 1.66945, 0.613827, 0.262875, 0.709993, -0.0263723, -0.0843107, 1.20479, 1.11558, 1.89236, 1.40103, 1.29989; -0.820804, -0.144763, 0.264916, -0.0470288, -0.118788, -0.462003, -0.14203, -0.439839, -0.12658, -0.29448, -1.00206, -2.16728, -2.08698, -1.25334, -1.50658, -1.4508, -1.67159, -1.17997, -2.06848, -1.97998, -2.01822, -2.21641, -0.880585, -1.49171, -1.64018, -2.14713, -2.56617, -1.56823, -1.40792, -2.26305, -2.09742, -2.57231, -2.31724, -2.3322, -2.4586, -2.0993, -1.76485, -0.98408, -1.20818, -0.914588, -0.855162, -0.777799, -0.623836, -0.698936, -0.258157, -0.115875, -0.785198, -0.213255, -0.576083, -0.637644, -1.01273, -1.43989, -2.01874, -1.18263, -1.0758, -0.343257, -1.46116, -1.10276, -0.974941, -1.6072, -0.642046, -1.22914, -1.26842; -0.698269, 0.12421, -0.0667509, 0.518349, 0.629377, 0.202037, 0.379192, 1.08821, 1.30278, 1.43485, 0.283542, -0.191856, 0.208373, -0.326965, -0.0892622, 0.277562, -0.332262, 0.637998, 0.44495, 0.15861, 0.0703759, -0.0587249, -0.36438, 0.211697, 0.345365, 0.707335, 0.491865, 0.986262, 1.20565, 1.51164, 1.17757, 0.858251, 1.63513, 1.57536, 1.10286, 1.30389, 0.191702, 0.95883, 0.275017, 0.147343, 0.365985, -0.0110329, -0.066433, -0.160359, -0.500883, -1.06675, -0.695027, -0.798855, -0.361056, 0.396244, -0.11244, 0.224742, 0.137763, 0.326652, 0.683171, 0.358266, 0.0110069, -0.167681, 0.225164, 0.147032, -0.0415897, -0.222934, -0.807287; -0.343214, -0.106352, -0.063576, -0.381768, -0.695696, -0.696329, -1.01699, -1.28137, -1.04042, -0.472998, -0.650449, -0.031027, -0.22484, 0.0584804, -0.1258, -0.0138667, -0.0244057, -1.26899, -2.79093, -3.48808, -4.42103, -3.75678, -2.68252, -2.13793, -1.88841, -1.84104, -1.4205, -1.60854, -1.89987, -1.53373, -1.64223, -1.14787, -1.52724, -1.59598, -1.12568, -0.971446, -0.0846586, -0.329101, -0.542174, -1.03843, -1.64551, -2.31362, -1.59478, -1.29774, -0.530024, -0.47507, -0.980799, -0.65311, -0.82328, -0.756474, -0.419687, -0.744737, -0.32617, -0.0384215, -0.147698, -0.521363, -0.105485, -0.0708306, 0.0374573, 0.430126, -0.182225, 0.33132, -0.321115; -1.18569, -0.765597, -0.248738, -0.408583, -0.564988, -0.479045, -1.03884, -1.07339, -1.35474, -1.71327, -1.06445, -1.18585, -1.21066, -1.57372, -0.712558, -1.03066, -0.462061, -0.699548, -0.0659538, -0.531632, -0.113098, -0.818243, -1.48526, -0.977996, -0.226048, 0.00426972, 0.193972, 0.074818, 0.385174, 0.981832, 1.10603, 0.632189, 0.748614, 0.636562, 0.330229, -0.522449, -0.567728, -0.856438, -1.38073, -0.577432, -0.694553, -0.344317, -0.07286, -0.127711, -0.442563, -0.216634, -0.126277, -0.165819, -0.267516, -0.610742, 0.0381401, 0.0115713, -0.212897, -1.00592, -0.45302, -1.05347, -0.693767, -1.27639, -0.670289, -0.569709, -0.540404, -1.09518, -0.655098; -0.404441, -0.321472, 0.0912931, -0.861811, -0.734892, -1.11183, -1.01565, -1.13762, -0.877061, 0.0971851, 0.596865, 0.0496559, -0.672867, -0.314636, 0.00703406, 0.0319614, -0.473215, -0.372124, 0.526154, 0.0706199, -0.404905, -0.453357, 0.0325659, -0.326051, -0.704362, -1.18423, -0.572317, -0.422345, -0.783044, -1.36461, -0.70643, 0.0188, -0.821038, -0.654578, -0.560348, -0.496656, -0.785067, -0.331383, -0.0933331, 0.0557681, -0.712332, -0.438004, -0.441625, 0.00186145, 0.526196, 0.568201, -0.136159, -0.0673589, -0.503046, -0.207695, -0.570964, -0.113101, 0.153768, 0.350134, 0.820237, 0.427736, 0.634852, 0.541811, 0.0818384, -0.269364, -0.389651, -0.352043, 0.101915; 0.064167, 0.31665, 0.358394, 0.207091, 0.225069, -0.09339, 0.00447866, -0.391237, 0.0408275, -0.475222, -0.0941192, -0.231464, -0.679674, -1.04877, -0.773694, -0.90969, -0.373756, -0.71377, -0.482549, -0.0685189, 0.687891, 0.366038, -0.535529, -0.508653, -0.520514, -0.31222, -0.321815, -0.643948, -0.460278, -0.560167, -0.754348, -0.307893, -0.262523, -0.332767, -0.639656, -1.21935, -0.929283, -1.0254, -1.50793, -1.5746, -0.754057, -0.487848, 0.172595, 0.577208, 0.327073, 0.900803, 0.794407, 0.964331, 0.191854, 0.444284, 0.45124, 0.630612, 1.01691, 0.337764, 0.154122, -0.235964, 0.530645, 0.471434, 0.192226, 0.156039, 0.11494, 0.205633, 0.642298];

figure;
 
subplot(311);
show_mfcc_data(cepstra(2:end, :));

subplot(312);
show_spectrum_data(ceps1(2:end,:));

subplot(313);
show_mfcc_data(cpp_out_cepstra(2:end,:));

